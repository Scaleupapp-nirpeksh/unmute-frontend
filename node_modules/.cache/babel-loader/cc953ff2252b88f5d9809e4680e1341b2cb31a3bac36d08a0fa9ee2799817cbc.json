{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{Box,Card,CardContent,Typography,Button,CircularProgress,Alert}from'@mui/material';import PhoneInput from'react-phone-input-2';import'react-phone-input-2/lib/style.css';import OTPInput from'../../components/Auth/OTPInput';import{authService}from'../../services/auth';import{useAuth}from'../../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Login(){const navigate=useNavigate();const{login}=useAuth();const[step,setStep]=useState(1);// Initialize with '+' so that the input always shows it.\nconst[phone,setPhone]=useState('+');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const handleSendOTP=async()=>{try{setLoading(true);setError('');// Ensure phone always starts with '+'\nconst formattedPhone=phone.startsWith('+')?phone:`+${phone}`;await authService.requestOTP(formattedPhone);setStep(2);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to send OTP');}finally{setLoading(false);}};const handleVerifyOTP=async otp=>{try{setLoading(true);setError('');const formattedPhone=phone.startsWith('+')?phone:`+${phone}`;const{data}=await authService.verifyOTP(formattedPhone,otp);login(data.token,data.user);navigate('/');}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Invalid OTP');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',// Updated to match Signup page color combo: teal-to-purple\nbackground:'linear-gradient(135deg, #80DEEA, #CE93D8)',display:'flex',alignItems:'center',justifyContent:'center',p:2},children:/*#__PURE__*/_jsx(Card,{sx:{width:{xs:'100%',sm:400},borderRadius:'20px',p:4,textAlign:'center'},elevation:6,children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",sx:{fontWeight:700,color:'#333',mb:2},children:\"Welcome Back\"}),step===1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",sx:{mb:3,color:'#555'},children:\"Enter your phone number to receive an OTP.\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsx(PhoneInput,{country:'us',value:phone,onChange:value=>setPhone(value.startsWith('+')?value:`+${value}`),inputStyle:{width:'100%',height:'40px',fontSize:'1rem'},containerStyle:{marginBottom:24}}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",size:\"large\",onClick:handleSendOTP,disabled:loading||!phone,sx:{py:1.5,fontSize:'1rem'},children:loading?/*#__PURE__*/_jsx(CircularProgress,{size:24}):'Send OTP'}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:2,color:'#777'},children:[\"New here?\",' ',/*#__PURE__*/_jsx(Button,{variant:\"text\",onClick:()=>navigate('/signup'),sx:{textTransform:'none',fontWeight:600},disabled:loading,children:\"Create account\"})]})]}),step===2&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",sx:{mb:3,color:'#555'},children:\"Enter the 6-digit OTP sent to your phone.\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsx(OTPInput,{length:6,onComplete:handleVerifyOTP,disabled:loading}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:2,color:'#777'},children:[\"Didn\\u2019t receive an OTP?\",' ',/*#__PURE__*/_jsx(Button,{variant:\"text\",onClick:handleSendOTP,sx:{textTransform:'none',fontWeight:600},disabled:loading,children:\"Resend OTP\"})]})]})]})})});}","map":{"version":3,"names":["React","useState","useNavigate","Box","Card","CardContent","Typography","Button","CircularProgress","Alert","PhoneInput","OTPInput","authService","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","navigate","login","step","setStep","phone","setPhone","loading","setLoading","error","setError","handleSendOTP","formattedPhone","startsWith","requestOTP","err","_err$response","_err$response$data","response","data","message","handleVerifyOTP","otp","verifyOTP","token","user","_err$response2","_err$response2$data","sx","minHeight","background","display","alignItems","justifyContent","p","children","width","xs","sm","borderRadius","textAlign","elevation","variant","fontWeight","color","mb","severity","country","value","onChange","inputStyle","height","fontSize","containerStyle","marginBottom","fullWidth","size","onClick","disabled","py","mt","textTransform","length","onComplete"],"sources":["/Users/nirpekshnandan/unmute-frontend/src/pages/Auth/Login.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  Box, \n  Card, \n  CardContent, \n  Typography, \n  Button, \n  CircularProgress, \n  Alert \n} from '@mui/material';\nimport PhoneInput from 'react-phone-input-2';\nimport 'react-phone-input-2/lib/style.css';\nimport OTPInput from '../../components/Auth/OTPInput';\nimport { authService } from '../../services/auth';\nimport { useAuth } from '../../contexts/AuthContext';\n\nexport default function Login() {\n  const navigate = useNavigate();\n  const { login } = useAuth();\n  const [step, setStep] = useState(1);\n  // Initialize with '+' so that the input always shows it.\n  const [phone, setPhone] = useState('+');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSendOTP = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      // Ensure phone always starts with '+'\n      const formattedPhone = phone.startsWith('+') ? phone : `+${phone}`;\n      await authService.requestOTP(formattedPhone);\n      setStep(2);\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to send OTP');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleVerifyOTP = async (otp) => {\n    try {\n      setLoading(true);\n      setError('');\n      const formattedPhone = phone.startsWith('+') ? phone : `+${phone}`;\n      const { data } = await authService.verifyOTP(formattedPhone, otp);\n      login(data.token, data.user);\n      navigate('/');\n    } catch (err) {\n      setError(err.response?.data?.message || 'Invalid OTP');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Box \n      sx={{ \n        minHeight: '100vh', \n        // Updated to match Signup page color combo: teal-to-purple\n        background: 'linear-gradient(135deg, #80DEEA, #CE93D8)', \n        display: 'flex', \n        alignItems: 'center', \n        justifyContent: 'center', \n        p: 2 \n      }}\n    >\n      <Card \n        sx={{ \n          width: { xs: '100%', sm: 400 }, \n          borderRadius: '20px', \n          p: 4, \n          textAlign: 'center' \n        }}\n        elevation={6}\n      >\n        <CardContent>\n          <Typography variant=\"h3\" sx={{ fontWeight: 700, color: '#333', mb: 2 }}>\n            Welcome Back\n          </Typography>\n\n          {step === 1 && (\n            <>\n              <Typography variant=\"subtitle1\" sx={{ mb: 3, color: '#555' }}>\n                Enter your phone number to receive an OTP.\n              </Typography>\n              {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\n              <PhoneInput\n                country={'us'}\n                value={phone}\n                onChange={(value) =>\n                  setPhone(value.startsWith('+') ? value : `+${value}`)\n                }\n                inputStyle={{ width: '100%', height: '40px', fontSize: '1rem' }}\n                containerStyle={{ marginBottom: 24 }}\n              />\n              <Button\n                fullWidth\n                variant=\"contained\"\n                size=\"large\"\n                onClick={handleSendOTP}\n                disabled={loading || !phone}\n                sx={{ py: 1.5, fontSize: '1rem' }}\n              >\n                {loading ? <CircularProgress size={24} /> : 'Send OTP'}\n              </Button>\n              <Typography variant=\"body2\" sx={{ mt: 2, color: '#777' }}>\n                New here?{' '}\n                <Button \n                  variant=\"text\" \n                  onClick={() => navigate('/signup')} \n                  sx={{ textTransform: 'none', fontWeight: 600 }}\n                  disabled={loading}\n                >\n                  Create account\n                </Button>\n              </Typography>\n            </>\n          )}\n\n          {step === 2 && (\n            <>\n              <Typography variant=\"subtitle1\" sx={{ mb: 3, color: '#555' }}>\n                Enter the 6-digit OTP sent to your phone.\n              </Typography>\n              {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\n              <OTPInput \n                length={6} \n                onComplete={handleVerifyOTP}\n                disabled={loading}\n              />\n              <Typography variant=\"body2\" sx={{ mt: 2, color: '#777' }}>\n                Didnâ€™t receive an OTP?{' '}\n                <Button \n                  variant=\"text\" \n                  onClick={handleSendOTP} \n                  sx={{ textTransform: 'none', fontWeight: 600 }}\n                  disabled={loading}\n                >\n                  Resend OTP\n                </Button>\n              </Typography>\n            </>\n          )}\n        </CardContent>\n      </Card>\n    </Box>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}